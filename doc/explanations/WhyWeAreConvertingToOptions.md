<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /doc/explanations/mdsource/WhyWeAreConvertingToOptions.source.md
To change this file edit the source file and then execute ./run_markdown_templates.sh.
-->

<a id="top"></a>

# Why We Are Converting To Options

<!-- toc -->
## Contents

  * [First Section Here](#first-section-here)
  * [API](#api)
  * [Opting in](#opting-in)<!-- endtoc -->

## First Section Here

2020-04-21

With the addition of Scrubbers, we realised that ApprovalTests has some optional parameters. The only one we had of these before was reporter. Because of that, we decided to group together all of the options in to a single container object. This gives us a few advantages:

1. We can expand in the future without changing the API.
2. Adding functionality becomes simpler, because it passes through to a single place.

It is effectively preparing to use the "Introduce Parameter Object" refactoring pattern.

## API

Our current pattern is to have an optional Reporter at the end of any verify() method.

We are switching this to have an option Options object instead.

This temporarily doubles our API interface, and we are deprecating the Reporter overloads.
When enabled, these deprecation warnings will show up as:
 
* compiler C++14 and above, using the `[[deprecated("..."]]` feature
* messages on std::cout in C++11

Our plan is to:
 
* start with the deprecations being something users can opt in to
* deprecation warnings are opt-out
* deprecation warnings are forced
* the deprecated methods are removed

## Opting in 

Currently (2020-04-21), warnings when using the old interface are turned off. To see them, add this line of code in your C++ code: 

<!-- snippet: show_deprecation_warnings -->
<a id='snippet-show_deprecation_warnings'/></a>
```cpp
#define APPROVALS_SHOW_DEPRECATION_WARNINGS
```
<sup><a href='/examples/doctest_existing_main/DoctestApprovalsTests.cpp#L1-L3' title='File snippet `show_deprecation_warnings` was extracted from'>snippet source</a> | <a href='#snippet-show_deprecation_warnings' title='Navigate to start of snippet `show_deprecation_warnings`'>anchor</a></sup>
<!-- endsnippet -->

Or this to your CMakeLists.txt:

<!-- snippet: show_deprecation_warnings_cmake -->
<a id='snippet-show_deprecation_warnings_cmake'/></a>
```txt
# Replace ${PROJECT_NAME} with the name of your test executable:
target_compile_definitions(${PROJECT_NAME} PRIVATE APPROVALS_SHOW_DEPRECATION_WARNINGS)
```
<sup><a href='/tests/DocTest_Tests/CMakeLists.txt#L43-L46' title='File snippet `show_deprecation_warnings_cmake` was extracted from'>snippet source</a> | <a href='#snippet-show_deprecation_warnings_cmake' title='Navigate to start of snippet `show_deprecation_warnings_cmake`'>anchor</a></sup>
<!-- endsnippet -->

---

[Back to User Guide](/doc/README.md#top)
