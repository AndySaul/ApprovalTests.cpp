<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /doc/how_tos/mdsource/ScrubInconsistentOutput.source.md
To change this file edit the source file and then execute ./run_markdown_templates.sh.
-->

<a id="top"></a>

# How to Scrub Inconsistent Output

<!-- toc -->
## Contents

  * [Introduction](#introduction)
  * [GUID](#guid)<!-- endtoc -->

## Introduction

If you are having trouble getting tests running reproducibly, you might need to use a "scrubber" to convert the non-deterministic text to something stable.

## GUID

You can scrub GUIDs by using a pointer to the function `Scrubbers::scrubGuid`, for example the following code:

<!-- snippet: guid_scrubbing -->
<a id='snippet-guid_scrubbing'/></a>
```cpp
std::string jsonFromRestCall = R"(
{
child: {
    id: b34b4da8-090e-49d8-bd35-7e79f633a2ea
    parent1: 2fd78d4a-ad49-447d-96a8-deda585a9aa5
    parent2: 05f77de3-3790-4d45-b045-def96c9cd371
}
person: {
    name: mom
    id: 2fd78d4a-ad49-447d-96a8-deda585a9aa5
}
person: {
    name: dad
    id: 05f77de3-3790-4d45-b045-def96c9cd371
}
}
)";
Approvals::verify(jsonFromRestCall, Options().withScrubber(Scrubbers::scrubGuid));
```
<sup><a href='/tests/DocTest_Tests/scrubbers/GuidScrubberTests.cpp#L33-L52' title='File snippet `guid_scrubbing` was extracted from'>snippet source</a> | <a href='#snippet-guid_scrubbing' title='Navigate to start of snippet `guid_scrubbing`'>anchor</a></sup>
<!-- endsnippet -->

will produce:

<!-- snippet: GuidScrubberTests.Input_with_multiple_GUIDs.approved.txt -->
<a id='snippet-GuidScrubberTests.Input_with_multiple_GUIDs.approved.txt'/></a>
```txt

{
    child: {
        id: guid_1
        parent1: guid_2
        parent2: guid_3
    }
    person: {
        name: mom
        id: guid_2
    }
    person: {
        name: dad
        id: guid_3
    }
}

```
<sup><a href='/tests/DocTest_Tests/scrubbers/approval_tests/GuidScrubberTests.Input_with_multiple_GUIDs.approved.txt#L1-L17' title='File snippet `GuidScrubberTests.Input_with_multiple_GUIDs.approved.txt` was extracted from'>snippet source</a> | <a href='#snippet-GuidScrubberTests.Input_with_multiple_GUIDs.approved.txt' title='Navigate to start of snippet `GuidScrubberTests.Input_with_multiple_GUIDs.approved.txt`'>anchor</a></sup>
<!-- endsnippet -->

Notice that when GUIDs are repeated within the same file, they are replaced with the same text.


---

[Back to User Guide](/doc/README.md#top)
